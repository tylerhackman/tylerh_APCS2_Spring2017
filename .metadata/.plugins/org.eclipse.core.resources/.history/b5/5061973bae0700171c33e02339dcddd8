package textExcel;



public class Spreadsheet implements Grid {
	
	private int numberOfRows = 20;
	private int numberOfColumns = 12;
	Cell [][] spreadsheet = new Cell [20][12];
	
	public Spreadsheet() {
	//	Cell [][] spreadsheet = new Cell [20][12];
		for(int i = 0; i < 20; i++) {
			for(int j = 0; j < 12; j++) {
				spreadsheet [i][j] = new EmptyCell();
			}
		}
	}
	
	public String processCommand(String command) {
		int row, column;
		String returnString = "";
		if (command.length() <= 3) {
			column = Character.getNumericValue(command.charAt(0)) - 10;
	    	row = Integer.valueOf((command.substring(1))) - 1;
	    	returnString = (spreadsheet [row] [column].fullCellText());
		}
		if (command.contains("=")) {
			String [] array = command.split(" ", 3);
			TextCell cell = new TextCell(array[2]);
			
			SpreadsheetLocation location = new SpreadsheetLocation(array[0]);
			spreadsheet[location.getRow()][location.getCol()] = cell;
			returnString = "string";
			
	}
		return returnString;
	}

	
	public int getRows() {
		return numberOfRows;
	}

	
	public int getCols() {
		return numberOfColumns;
	}

	
	public Cell getCell(Location loc) {
		
		return null;
	}

	public String getGridText() {
		String grid = "   |";
		char colCount = 'A';
		
		for(int row = 0; row < 21; row++) {
			for(int col = 0; col < 12; col++) {
				if(row == 0) {
					grid += "" + colCount + "         |";
				}
					else {
						if (col == 0) {
							if(row < 10) {
								grid += "" + row + "  |";
							}
								else {
									grid += "" + row + " |";
								}
						
						}
							else {
								if(spreadsheet [row] [col].equals("")){
									grid += "          |";
								}
								else{
									grid += spreadsheet[row][col].abbreviatedCellText() + "|";
							}
					}
				colCount++;
			}
			if (row != 0) {
				grid += "          |";
			}
			grid += "\n";
		}
		return grid;
	}

}
